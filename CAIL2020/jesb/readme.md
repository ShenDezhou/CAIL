# 1. 合同金额识别模型

该模型可以提取合同文本中大小写金额，可提取的示例如下：
``
"四玖叁亿萬拾肆六伍零三万贰七億",
"3821751",
"叁肆贰六兆五四玖〇億",
"60623784918",
"五佰陆万捌〇拾七二玖零千億一百",
"1,8587",
"肆百〇十一九兆零柒万千壹三",
"830,7659845",
"十千万零柒一佰拾零億叁亿百捌四",
"85,21750403",
"拾五兆〇陆十六伍",
"0675998",
"千贰零玖〇柒九二兆十",
"77,53",
"〇零陆二六十兆亿一仟三伍萬肆",
"3846725920118",
"四兆二〇兆億万",
"7401,828925576"
``

# 2. 调用请求方法
数据准备，对于docx格式和同文本可用pandoc程序转成md或txt格式文本。命令：`pandoc -s xxx.docx -o xxx.md`

接口支持HTTP的GET与POST方式。
以接口地址为`http://localhost:58081/z`为例

## 2.1 GET
http://localhost:58081/z?1=**建设工程监理合同**\n\n**（示范文本）**\n\n**第一部分

## 2.2 POST

*  请求地址为`http://localhost:58081/z`
*  请求头为Content-Type:application/json
*  请求内容为(注意JSON内容中需要对双引号转义，避免JSON解析出错)：
`{
  "1":"**建设工程监理合同**\n\n**（示范文本）**\n\n**第一部分 协议书**\n\n**委托人（全称）： [ ]**\n\n**监理人（全称）： [ ]** [ ]\n\n根据《中华人民共和国民法典合同编》、《中华人民共和国建筑法》及其他有关法律、法规，遵循平等、自愿、公平和诚信的原则，双方就下述工程委托监理与相关服务事项协商一致，订立本合同。\n\n**一、工程概况**\n\n1\. 工程名称： [ ] ；\n\n2\. 工程地点： [ ] ；\n\n3\. 工程规模： [ ] ；\n\n4\. 工程概算投资额或建筑安装工程费： [ ] 。\n\n**二、词语限定**\n\n协议书中相关词语的含义与通用条件中的定义与解释相同。\n\n**三、组成本合同的文件**\n\n1\. 协议书；\n\n2\. 中标通知书（适用于招标工程）或委托书（适用于非招标工程）；\n\n3\.\n投标文件（适用于招标工程）或监理与相关服务建议书（适用于非招标工程）；\n\n4\. 专用条件；\n\n5\. 通用条件；\n\n6\. 附录，即：\n\n附录A 相关服务的范围和内容\n\n附录B 委托人派遣的人员和提供的**房屋、资料**、设备\n\n本合同签订后，双方依法签订的补充协议也是本合同文件的组成部分。\n\n**四、总监理工程师**\n\n总监理工程师姓名： [ ] ，身份证号码： [ ]\n，注册号： [ ] 。\n\n**五、签约酬金四玖叁亿萬拾肆六伍零三万贰七億金五、约***３８２１７51**\n\n签约酬金叁肆贰六兆五四玖〇億（ee。）签酬id（金 ¥{.  ]}６062３7８４９１8（大写）： [ ] （¥ ）。\n\n包括：\n\n1\. 监理酬金五佰陆万捌〇拾七二玖零千億一百 ldeu酬.n[ 金r1,８58７： [ ] 。\n\n2\. 相关服务酬金肆百〇十一九兆零柒万千壹三ud相 nni] ：[e{服 。.\务 .8３０,７６59８４５： [ ] 。\n\n其中：\n\n（1）勘察阶段服务酬金十千万零柒一佰拾零億叁亿百捌四（服[金段enr阶。1un察）d务酬ie.  8５,2１７50４０３： [ ] 。\n\n（2）设计阶段服务酬金拾五兆〇陆十六伍e：]{n ）务段 。０6７５9９8： [ ] 。\n\n（3）保修阶段服务酬金千贰零玖〇柒九二兆十修：  ）金n（nr}务[e3酬d服7７,5３： [ ] 。\n\n（4）其他相关服务酬金〇零陆二六十兆亿一仟三伍萬肆dn３８4672５9２０１18： [ ] 。\n\n**六、期限**\n\n1\. 监理期限：\n\n自 [ ] 年 [ ] 月 [ ] 日始，至 [\n] 年 [ ] 月 [ ] 日止。\n\n2\. 相关服务期限：\n\n（1）勘察阶段服务期限自 [ ] 年 [ ] 月 [\n] 日始，至 [ ] 年 [ ] 月 [\n] 日止。\n\n（2）设计阶段服务期限自 [ ] 年 [ ] 月 [\n] 日始，至 [ ] 年 [ ] 月 [\n] 日止。\n\n（3）保修阶段服务期限自 [ ] 年 [ ] 月 [\n] 日始，至 [ ] 年 [ ] 月 [\n] 日止。\n\n（4）其他相关服务期限自 [ ] 年 [ ] 月 [\n] 日始，至 [ ] 年 [ ] 月 [\n] 日止。\n\n**七、双方承诺**\n\n1\. 监理人向委托人承诺，按照本合同约定提供监理与相关服务。\n\n2\.\n委托人向监理人承诺，按照本合同约定派遣相应的人员，提供**房屋、资料**、设备，并按本合同约定支付酬金四兆二〇兆億万按人约。委照按供、设*定合资，料同、遣房，人定*员派并承向屋监本*理付约酬诺托７40１,８289２5５7６。\n\n**八、合同订立**\n\n1\. 订立时间： [ ] 年 [ ] 月 [ ]\n日。\n\n2\. 订立地点： [ ] 。\n\n> 3\. 本合同一式 [ ] 份，具有同等法律效力，双方各执\n>\n> [ ] 份。\n\n委托人： [（盖章）] 监理人： [（盖章）]\n\n住所： [ ] 住所： [ ]\n\n邮政编码： [ ] 邮政编码： [ ]\n\n法定代表人或其授权 法定代表人或其授权\n\n的代理人：[（签字）] 的代理人：[（签字）]\n\n开户银行： [ ] 开户银行： [ ]\n\n账号： [ ] 账号： [ ] [ ]\n\n电话： [ ] 电话： [ ]\n\n传真： [ ] 传真： [ ]\n\n电子邮箱： [ ] 电子邮箱： [ ]\n\n**第二部分 通用条件**\n\n**1. 定义与解释**\n\n> 1.1 **定义**\n\n除根据上下文另有其意义外，组成本合同的全部文件中的下列名词和用语应具有本款所赋予的含义：\n\n1.1.1 \"\"工程\"\"是指按照本合同约定实施监理与相关服务的建设工程。\n\n1.1.2\n\"\"委托人\"\"是指本合同中委"
}`

## 2.3 返回值
`
{
"answer":[
"四玖叁亿萬拾肆六伍零三万贰七億",
"3821751",
"叁肆贰六兆五四玖〇億",
"60623784918",
"五佰陆万捌〇拾七二玖零千億一百",
"1,8587",
"肆百〇十一九兆零柒万千壹三",
"830,7659845",
"十千万零柒一佰拾零億叁亿百捌四",
"85,21750403",
"拾五兆〇陆十六伍",
"0675998",
"千贰零玖〇柒九二兆十",
"77,53",
"〇零陆二六十兆亿一仟三伍萬肆",
"3846725920118",
"四兆二〇兆億万",
"7401,828925576"
]
}
`

## 2.4. 测试模型地址
`
192.168.0.161:58084/z
`

# 3. 模型精度
务必在合同文本中包含\n字符标识段落。模型无法接受超长段落文本。
模型精度为95%~99%区间。
模型网络结构为BiLSTM+CRF。


# 4. 作者
模型：wuyuting  
服务：shendezhou  


# 5. 模型效能讨论
以测试集第一篇为例，模型输出见[#1.txt](!testset-model-output-for-#1.txt)。
* ,8587：这个为测试集标记错误，测试集原文可见`1,８58７`。
* 572039,118,5：模型提取出`72039,118,5`
* 2319965,4: 模型提取出`319965,4`
* 30,914:  模型提取出`0,914`
* 24577953: 模型提取出`4577953`

讨论，在这篇合同例子中，错误率为：4/80，即准确率为95%。错误原因为合同中存在的大量的序号，如1. 2. 3. 4.等，模型在训练过程中收到的信号为这些字符非金额，因而干扰了模型识别这些数字开头的金额。
未来工作，可以利用规则来补充提取这类数字。可以看出模型对于大写金额提取是符合预期的。


# 6. 遗留问题
测试用例第三篇中：
* `２１1５9６6`未识别： `（2）委托人与监理人结清并支付全部酬金兆八拾兆陆玖2理）监并结委支清全托人金付与２１1５9６6`。
* `０1034１`未识别：  `6.2.3附加工作酬金兆陆四五亿捌按工确金.列０1034１按下列方法确定：`。
有两条未召回，第三篇中80个金额中召回78个，并且召回的金额全部正确。
以前三篇（240个）作为统计来看，增加了数字金额识别向前扩招的调整后，精度为99.17%。

# 7. 结论
纯模型由于训练语料中含有序号的噪声，导致模型对于数字起始位置的判断有些误差，并且对于某些数字金额无法召回，精度在95%。
对于数字起始位置误差的问题，利用规则将模型识别的数字金额重新在原文中查找，并将相邻的数字召回，提高了4.1%的精度。
对于某些数字金额无法召回的问题，在此模型无法有效解决，并且利用正则的方法也容易召回日期等错误，这类错误占比不足0.8%，本次实验不处理该类错误。

# 8. 服务说明
对客户端要求：内容中的双引号在发送到服务器前需要转义成\"，JSON的要求；
转义后，全文中所有斜杠（\），如\n符号的斜杠，均需要转义为双斜杠(\\)，服务器要求（2.2示例中为了便于阅读，并未对斜杠转义）。

* 符号“:可以在发送前过滤掉，对模型不重要。
* 符号\n:不可以去掉，因为模型是按段落处理，该符号是拆分标志，不可以删除。